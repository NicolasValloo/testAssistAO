<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AssistAO ‚Äî March√©s publics intelligents</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,600;0,700&family=DM+Mono:wght@400;500&family=Playfair+Display:wght@600;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #FAF8F5;
  --bg-dark: #0F1117;
  --card: #FFFFFF;
  --card-dark: #1A1D27;
  --border: #E8E4DE;
  --border-dark: #2A2E3B;
  --accent: #C45D3E;
  --accent-light: #F4DDD6;
  --blue: #4A90D9;
  --green: #3A9D5C;
  --yellow: #D4A843;
  --purple: #8B5CF6;
  --cyan: #22D3EE;
  --text: #1A1A1A;
  --text-mid: #6B6560;
  --text-dim: #9CA3AF;
  --serif: 'Playfair Display', Georgia, serif;
  --sans: 'DM Sans', -apple-system, sans-serif;
  --mono: 'DM Mono', 'Consolas', monospace;
}

* { margin: 0; padding: 0; box-sizing: border-box; }
html { scroll-behavior: smooth; }
body { font-family: var(--sans); color: var(--text); background: var(--bg); overflow-x: hidden; }

/* ‚ïê‚ïê‚ïê ANIMATIONS ‚ïê‚ïê‚ïê */
@keyframes fadeUp { from { opacity: 0; transform: translateY(24px); } to { opacity: 1; transform: translateY(0); } }
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
@keyframes slideRight { from { width: 0; } to { width: 100%; } }
@keyframes pulse { 0%,100% { opacity: 1; } 50% { opacity: 0.5; } }
@keyframes spin { to { transform: rotate(360deg); } }
@keyframes countUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
@keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
.fade-up { animation: fadeUp 0.6s ease both; }
.fade-up-d1 { animation: fadeUp 0.6s 0.1s ease both; }
.fade-up-d2 { animation: fadeUp 0.6s 0.2s ease both; }
.fade-up-d3 { animation: fadeUp 0.6s 0.3s ease both; }
.fade-up-d4 { animation: fadeUp 0.6s 0.4s ease both; }
.fade-in { animation: fadeIn 0.4s ease both; }

/* ‚ïê‚ïê‚ïê PAGE SYSTEM ‚ïê‚ïê‚ïê */
.page { display: none; min-height: 100vh; }
.page.active { display: block; }

/* ‚ïê‚ïê‚ïê NAV ‚ïê‚ïê‚ïê */
.nav { position: fixed; top: 0; left: 0; right: 0; z-index: 100; backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); background: rgba(250,248,245,0.85); border-bottom: 1px solid var(--border); }
.nav-inner { max-width: 1180px; margin: 0 auto; padding: 0 28px; height: 60px; display: flex; align-items: center; justify-content: space-between; }
.logo { font-family: var(--serif); font-size: 22px; font-weight: 700; color: var(--text); cursor: pointer; letter-spacing: -0.5px; }
.logo span { color: var(--accent); }
.nav-links { display: flex; gap: 8px; align-items: center; }
.nav-links a, .nav-links button { font-family: var(--sans); font-size: 13px; font-weight: 600; text-decoration: none; color: var(--text-mid); padding: 8px 16px; border-radius: 8px; border: none; cursor: pointer; background: transparent; transition: all 0.2s; }
.nav-links a:hover, .nav-links button:hover { color: var(--text); background: rgba(0,0,0,0.04); }
.btn-primary { background: var(--accent) !important; color: white !important; }
.btn-primary:hover { background: #B34D2E !important; transform: translateY(-1px); box-shadow: 0 4px 14px rgba(196,93,62,0.3); }
.btn-outline { border: 1.5px solid var(--border) !important; color: var(--text) !important; }
.btn-outline:hover { border-color: var(--accent) !important; color: var(--accent) !important; }

/* ‚ïê‚ïê‚ïê LANDING ‚ïê‚ïê‚ïê */
.hero { padding: 140px 28px 80px; max-width: 1180px; margin: 0 auto; text-align: center; }
.hero-tag { display: inline-block; font-family: var(--mono); font-size: 11px; font-weight: 500; color: var(--accent); background: var(--accent-light); padding: 6px 14px; border-radius: 100px; margin-bottom: 24px; letter-spacing: 0.5px; text-transform: uppercase; }
.hero h1 { font-family: var(--serif); font-size: clamp(36px, 5vw, 56px); font-weight: 800; line-height: 1.1; color: var(--text); margin-bottom: 20px; letter-spacing: -1.5px; }
.hero h1 em { font-style: normal; color: var(--accent); }
.hero p { font-size: 17px; color: var(--text-mid); max-width: 560px; margin: 0 auto 36px; line-height: 1.6; }
.hero-cta { display: inline-flex; align-items: center; gap: 10px; font-family: var(--sans); font-size: 16px; font-weight: 700; color: white; background: var(--accent); padding: 16px 36px; border-radius: 12px; border: none; cursor: pointer; transition: all 0.25s; }
.hero-cta:hover { background: #B34D2E; transform: translateY(-2px); box-shadow: 0 8px 24px rgba(196,93,62,0.3); }
.hero-sub { font-size: 13px; color: var(--text-dim); margin-top: 14px; }

/* Preview cards */
.preview-section { max-width: 900px; margin: 0 auto 80px; padding: 0 28px; }
.preview-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; }
.preview-card { background: var(--card); border: 1px solid var(--border); border-radius: 14px; padding: 20px; transition: all 0.3s; cursor: pointer; position: relative; overflow: hidden; }
.preview-card:hover { transform: translateY(-4px); box-shadow: 0 12px 32px rgba(0,0,0,0.08); border-color: var(--accent); }
.preview-score { display: inline-flex; align-items: center; gap: 4px; font-family: var(--mono); font-size: 14px; font-weight: 700; padding: 4px 10px; border-radius: 8px; margin-bottom: 12px; }
.score-high { color: var(--green); background: rgba(58,157,92,0.1); }
.score-mid { color: var(--yellow); background: rgba(212,168,67,0.1); }
.preview-card h3 { font-size: 14px; font-weight: 700; color: var(--text); margin-bottom: 6px; line-height: 1.3; }
.preview-card p { font-size: 12px; color: var(--text-mid); margin-bottom: 10px; }
.preview-card .tag { display: inline-block; font-size: 10px; font-weight: 600; color: var(--accent); background: var(--accent-light); padding: 3px 8px; border-radius: 4px; margin-right: 4px; }
.preview-card .deadline { font-size: 11px; color: var(--text-dim); margin-top: 8px; font-family: var(--mono); }

/* Features */
.features { max-width: 1000px; margin: 0 auto 80px; padding: 0 28px; }
.features h2 { font-family: var(--serif); font-size: 28px; text-align: center; margin-bottom: 40px; letter-spacing: -0.5px; }
.features-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
.feature-card { padding: 28px; border-radius: 16px; border: 1px solid var(--border); background: var(--card); transition: all 0.3s; }
.feature-card:hover { border-color: var(--accent); box-shadow: 0 8px 24px rgba(0,0,0,0.06); }
.feature-icon { font-size: 28px; margin-bottom: 14px; }
.feature-card h3 { font-size: 16px; font-weight: 700; margin-bottom: 8px; }
.feature-card p { font-size: 13px; color: var(--text-mid); line-height: 1.5; }

/* Metrics */
.metrics { display: flex; justify-content: center; gap: 60px; margin: 0 auto 80px; padding: 40px 28px; background: var(--bg-dark); border-radius: 20px; max-width: 800px; }
.metric { text-align: center; }
.metric-val { font-family: var(--serif); font-size: 36px; font-weight: 700; color: var(--accent); }
.metric-label { font-size: 13px; color: rgba(255,255,255,0.5); margin-top: 4px; }

/* ‚ïê‚ïê‚ïê ONBOARDING ‚ïê‚ïê‚ïê */
.onboarding { padding: 100px 28px 60px; max-width: 680px; margin: 0 auto; }
.step-indicator { display: flex; align-items: center; gap: 0; margin-bottom: 40px; }
.step-dot { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-family: var(--mono); font-size: 13px; font-weight: 700; flex-shrink: 0; transition: all 0.3s; }
.step-dot.active { background: var(--accent); color: white; }
.step-dot.done { background: var(--green); color: white; }
.step-dot.pending { background: var(--border); color: var(--text-dim); }
.step-line { flex: 1; height: 2px; background: var(--border); }
.step-line.done { background: var(--green); }
.onboarding h2 { font-family: var(--serif); font-size: 28px; margin-bottom: 6px; letter-spacing: -0.5px; }
.onboarding .subtitle { font-size: 14px; color: var(--text-mid); margin-bottom: 28px; }

/* Form */
.form-group { margin-bottom: 18px; }
.form-label { display: block; font-size: 13px; font-weight: 600; color: var(--text); margin-bottom: 6px; }
.form-input { width: 100%; padding: 14px 16px; border: 1.5px solid var(--border); border-radius: 10px; font-family: var(--sans); font-size: 15px; background: white; transition: border-color 0.2s; outline: none; }
.form-input:focus { border-color: var(--accent); }
.form-input.input-error { border-color: #DC2626; }
.form-input.input-ok { border-color: var(--green); }
.field-error { font-size: 12px; color: #DC2626; margin-top: 4px; min-height: 16px; font-weight: 500; }
.btn-block { width: 100%; padding: 16px; font-family: var(--sans); font-size: 15px; font-weight: 700; color: white; background: var(--accent); border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s; }
.btn-block:hover { background: #B34D2E; }
.btn-block:disabled { background: var(--text-dim); cursor: not-allowed; }

/* Profile card */
.profile-result { background: white; border: 1.5px solid var(--green); border-radius: 14px; padding: 24px; margin: 24px 0; }
.profile-result h3 { font-size: 18px; font-weight: 700; margin-bottom: 4px; }
.profile-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 16px; }
.profile-field { font-size: 12px; }
.profile-field .label { color: var(--text-dim); font-weight: 500; }
.profile-field .value { color: var(--text); font-weight: 600; margin-top: 2px; }
.badge-green { display: inline-flex; align-items: center; gap: 4px; font-size: 11px; font-weight: 600; color: var(--green); background: rgba(58,157,92,0.1); padding: 4px 10px; border-radius: 6px; }

/* Competences */
.comp-grid { display: flex; flex-wrap: wrap; gap: 8px; margin: 16px 0; }
.comp-tag { display: inline-flex; align-items: center; gap: 6px; font-size: 12px; font-weight: 600; padding: 8px 14px; border-radius: 8px; border: 1.5px solid var(--border); background: white; cursor: pointer; transition: all 0.2s; }
.comp-tag.active { border-color: var(--accent); background: var(--accent-light); color: var(--accent); }
.comp-tag .src { font-size: 9px; font-weight: 700; padding: 2px 5px; border-radius: 3px; text-transform: uppercase; }
.src-decp { color: var(--green); background: rgba(58,157,92,0.1); }
.src-m2bpo { color: var(--blue); background: rgba(74,144,217,0.1); }
.src-web { color: var(--yellow); background: rgba(212,168,67,0.1); }

/* References */
.ref-card { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; border: 1px solid var(--border); border-radius: 10px; margin-bottom: 8px; background: white; }
.ref-card h4 { font-size: 13px; font-weight: 700; margin-bottom: 2px; }
.ref-card p { font-size: 11px; color: var(--text-mid); }
.ref-amount { font-family: var(--mono); font-size: 13px; font-weight: 700; color: var(--accent); text-align: right; white-space: nowrap; }
.ref-year { font-size: 11px; color: var(--text-dim); }

/* Preferences */
.pref-row { display: flex; align-items: center; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid var(--border); }
.pref-row:last-child { border: none; }
.pref-label { font-size: 14px; font-weight: 600; }
.pref-desc { font-size: 12px; color: var(--text-mid); }
.pref-select { padding: 10px 14px; border: 1.5px solid var(--border); border-radius: 8px; font-family: var(--sans); font-size: 13px; background: white; cursor: pointer; outline: none; min-width: 180px; }
.pref-select:focus { border-color: var(--accent); }

/* ‚ïê‚ïê‚ïê DASHBOARD ‚ïê‚ïê‚ïê */
.dash { padding: 80px 28px 60px; max-width: 1100px; margin: 0 auto; }
.dash-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 20px; }
.dash-header h1 { font-family: var(--serif); font-size: 28px; letter-spacing: -0.5px; }
.dash-header p { font-size: 13px; color: var(--text-mid); margin-top: 4px; }

/* Dashboard tabs */
.dash-tabs { display: flex; gap: 0; margin-bottom: 24px; border-bottom: 2px solid var(--border); }
.dash-tab { padding: 12px 24px; font-family: var(--sans); font-size: 14px; font-weight: 600; color: var(--text-mid); background: none; border: none; cursor: pointer; position: relative; transition: color 0.2s; }
.dash-tab:hover { color: var(--text); }
.dash-tab.active { color: var(--accent); }
.dash-tab.active::after { content: ''; position: absolute; bottom: -2px; left: 0; right: 0; height: 2px; background: var(--accent); }
.dash-tab .tab-icon { margin-right: 6px; }
.dash-tab-content { display: none; }
.dash-tab-content.active { display: block; }

.dash-filters { display: flex; gap: 8px; }
.filter-btn { font-family: var(--sans); font-size: 12px; font-weight: 600; padding: 8px 14px; border: 1.5px solid var(--border); border-radius: 8px; background: white; cursor: pointer; transition: all 0.15s; color: var(--text-mid); }
.filter-btn:hover, .filter-btn.active { border-color: var(--accent); color: var(--accent); background: var(--accent-light); }

/* Stats bar */
.stats-bar { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 24px; }
.stat-card { background: white; border: 1px solid var(--border); border-radius: 12px; padding: 16px; }
.stat-val { font-family: var(--mono); font-size: 24px; font-weight: 700; color: var(--text); }
.stat-label { font-size: 12px; color: var(--text-mid); margin-top: 2px; }

/* March√© cards */
.marche-list { display: flex; flex-direction: column; gap: 12px; }
.marche-card { background: white; border: 1px solid var(--border); border-radius: 14px; padding: 20px 24px; display: flex; gap: 20px; cursor: pointer; transition: all 0.25s; position: relative; }
.marche-card:hover { border-color: var(--accent); box-shadow: 0 8px 28px rgba(0,0,0,0.07); transform: translateY(-2px); }
.marche-card.new::before { content: ''; position: absolute; top: 0; left: 0; bottom: 0; width: 4px; background: var(--accent); border-radius: 14px 0 0 14px; }
.marche-score { text-align: center; flex-shrink: 0; width: 60px; }
.marche-score .score-num { font-family: var(--mono); font-size: 22px; font-weight: 700; }
.marche-score .score-label { font-size: 9px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.5px; }
.score-green .score-num { color: var(--green); }
.score-yellow .score-num { color: var(--yellow); }
.marche-body { flex: 1; min-width: 0; }
.marche-body h3 { font-size: 15px; font-weight: 700; color: var(--text); margin-bottom: 4px; line-height: 1.3; }
.marche-meta { font-size: 12px; color: var(--text-mid); margin-bottom: 8px; }
.marche-tags { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 10px; }
.marche-tags .tag { font-size: 10px; font-weight: 600; padding: 3px 8px; border-radius: 4px; }
.tag-domain { color: var(--blue); background: rgba(74,144,217,0.1); }
.tag-type { color: var(--purple); background: rgba(139,92,246,0.1); }
.tag-top { color: var(--accent); background: var(--accent-light); }
.marche-ai { background: #F9F7F4; border-radius: 8px; padding: 10px 14px; font-size: 12px; color: var(--text-mid); line-height: 1.4; }
.marche-ai strong { color: var(--text); font-weight: 600; }
.marche-right { text-align: right; flex-shrink: 0; min-width: 120px; }
.marche-amount { font-family: var(--mono); font-size: 15px; font-weight: 700; color: var(--text); }
.marche-deadline { font-size: 12px; color: var(--text-dim); margin-top: 4px; }
.marche-deadline.urgent { color: #DC2626; font-weight: 600; }

/* ‚ïê‚ïê‚ïê DETAIL ‚ïê‚ïê‚ïê */
.detail { padding: 80px 28px 60px; max-width: 1100px; margin: 0 auto; }
.detail-back { display: inline-flex; align-items: center; gap: 6px; font-size: 13px; color: var(--text-mid); cursor: pointer; margin-bottom: 20px; transition: color 0.2s; border: none; background: none; font-family: var(--sans); }
.detail-back:hover { color: var(--accent); }
.detail-grid { display: grid; grid-template-columns: 1fr 320px; gap: 24px; }
.detail-main { background: white; border: 1px solid var(--border); border-radius: 16px; padding: 28px; }
.detail-main h1 { font-family: var(--serif); font-size: 24px; line-height: 1.25; margin-bottom: 12px; letter-spacing: -0.5px; }
.detail-main .meta-row { display: flex; gap: 20px; font-size: 13px; color: var(--text-mid); margin-bottom: 20px; flex-wrap: wrap; }
.detail-main .meta-row span { display: flex; align-items: center; gap: 4px; }
.detail-score-bar { display: flex; gap: 12px; margin-bottom: 24px; padding: 16px; background: #F9F7F4; border-radius: 12px; }
.score-pill { flex: 1; text-align: center; padding: 10px 0; border-radius: 8px; background: white; border: 1px solid var(--border); }
.score-pill .pill-val { font-family: var(--mono); font-size: 18px; font-weight: 700; }
.score-pill .pill-label { font-size: 10px; color: var(--text-dim); margin-top: 2px; }
.score-pill.main { border-color: var(--accent); background: var(--accent-light); }
.score-pill.main .pill-val { color: var(--accent); }
.detail-section { margin-bottom: 24px; }
.detail-section h3 { font-size: 15px; font-weight: 700; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
.ai-reasons { display: flex; flex-direction: column; gap: 8px; }
.ai-reason { display: flex; gap: 10px; padding: 12px 14px; background: #F9F7F4; border-radius: 10px; font-size: 13px; color: var(--text); line-height: 1.4; }
.ai-reason .icon { flex-shrink: 0; }

/* Detail sidebar */
.detail-sidebar { display: flex; flex-direction: column; gap: 14px; }
.sidebar-card { background: white; border: 1px solid var(--border); border-radius: 14px; padding: 20px; }
.sidebar-card h4 { font-size: 13px; font-weight: 700; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 14px; }
.sidebar-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--border); font-size: 13px; }
.sidebar-row:last-child { border: none; }
.sidebar-row .label { color: var(--text-mid); }
.sidebar-row .val { font-weight: 600; color: var(--text); }
.btn-sidebar { width: 100%; padding: 14px; font-family: var(--sans); font-size: 14px; font-weight: 700; border-radius: 10px; border: none; cursor: pointer; transition: all 0.2s; margin-top: 8px; }
.btn-sidebar.primary { background: var(--accent); color: white; }
.btn-sidebar.primary:hover { background: #B34D2E; }
.btn-sidebar.secondary { background: transparent; border: 1.5px solid var(--border); color: var(--text); }
.btn-sidebar.secondary:hover { border-color: var(--accent); color: var(--accent); }

/* Team suggested */
.team-member { display: flex; align-items: center; gap: 12px; padding: 10px 0; border-bottom: 1px solid var(--border); }
.team-member:last-child { border: none; }
.team-avatar { width: 36px; height: 36px; border-radius: 50%; background: var(--border); display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: 700; color: var(--text-mid); flex-shrink: 0; }
.team-info { flex: 1; }
.team-info .name { font-size: 13px; font-weight: 600; }
.team-info .role { font-size: 11px; color: var(--text-mid); }
.team-score { font-family: var(--mono); font-size: 12px; font-weight: 700; color: var(--green); }

/* Autocomplete */
.autocomplete-list { position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1.5px solid var(--border); border-top: none; border-radius: 0 0 10px 10px; max-height: 240px; overflow-y: auto; z-index: 50; display: none; box-shadow: 0 8px 24px rgba(0,0,0,0.08); }
.autocomplete-list.show { display: block; }
.autocomplete-item { padding: 12px 16px; cursor: pointer; transition: background 0.15s; border-bottom: 1px solid var(--border); }
.autocomplete-item:last-child { border-bottom: none; }
.autocomplete-item:hover { background: var(--accent-light); }
.autocomplete-item .ac-name { font-size: 14px; font-weight: 600; color: var(--text); }
.autocomplete-item .ac-meta { font-size: 11px; color: var(--text-mid); margin-top: 2px; font-family: var(--mono); }
.autocomplete-item .ac-highlight { color: var(--accent); font-weight: 700; }
.autocomplete-hint { padding: 10px 16px; font-size: 12px; color: var(--text-dim); font-style: italic; }

/* ‚ïê‚ïê‚ïê RESPONSIVE ‚ïê‚ïê‚ïê */
@media (max-width: 768px) {
  .preview-grid, .features-grid { grid-template-columns: 1fr; }
  .stats-bar { grid-template-columns: 1fr 1fr; }
  .detail-grid { grid-template-columns: 1fr; }
  .metrics { flex-direction: column; gap: 24px; }
  .marche-card { flex-direction: column; }
  .marche-right { text-align: left; }
  .profile-grid { grid-template-columns: 1fr; }
  .nav-links a:not(.btn-primary) { display: none; }
}
</style>
</head>
<body>

<!-- NAV -->
<nav class="nav">
  <div class="nav-inner">
    <div class="logo" onclick="showPage('landing')">Assist<span>AO</span></div>
    <div class="nav-links" id="navLinks">
      <button class="btn-outline" onclick="showPage('onboarding')">Connexion</button>
      <button class="btn-primary" onclick="showPage('onboarding')">Inscription</button>
    </div>
  </div>
</nav>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- LANDING PAGE -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page active" id="page-landing">
  <section class="hero">
    <div class="fade-up">
      <div class="hero-tag">‚ú¶ IA pour les march√©s publics MOE</div>
    </div>
    <h1 class="fade-up-d1">Trouvez les march√©s publics<br><em>faits pour vous</em></h1>
    <p class="fade-up-d2">AssistAO analyse votre profil d'architecte ou bureau d'√©tudes et vous recommande les march√©s publics les plus pertinents. Fini les heures de veille manuelle.</p>
    <button class="hero-cta fade-up-d3" onclick="showPage('onboarding')">
      Inscription
      <svg width="18" height="18" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"><path d="M4 9h10M10 5l4 4-4 4"/></svg>
    </button>
    <div class="hero-sub fade-up-d4">Gratuit ¬∑ Sans engagement ¬∑ SIRET suffit</div>
  </section>

  <section class="preview-section">
    <div class="preview-grid">
      <div class="preview-card fade-up-d1" onclick="showPage('detail')">
        <div class="preview-score score-high">‚ú¶ 94%</div>
        <h3>Restructuration groupe scolaire Victor Hugo</h3>
        <p>Ville de Bordeaux ¬∑ Gironde</p>
        <span class="tag">√âducation</span><span class="tag">R√©habilitation</span>
        <div class="deadline">‚è∞ Date limite : 15/04/2026</div>
      </div>
      <div class="preview-card fade-up-d2" onclick="showPage('detail')">
        <div class="preview-score score-high">‚ú¶ 87%</div>
        <h3>Construction m√©diath√®que intercommunale</h3>
        <p>CC Pays de Retz ¬∑ Loire-Atlantique</p>
        <span class="tag">Culture</span><span class="tag">Neuf</span>
        <div class="deadline">‚è∞ Date limite : 22/04/2026</div>
      </div>
      <div class="preview-card fade-up-d3" onclick="showPage('detail')">
        <div class="preview-score score-mid">‚ú¶ 76%</div>
        <h3>R√©habilitation EHPAD Les Glycines ‚Äî 80 lits</h3>
        <p>D√©partement du Finist√®re</p>
        <span class="tag">Sant√©</span><span class="tag">HQE</span>
        <div class="deadline">‚è∞ Date limite : 08/04/2026</div>
      </div>
    </div>
  </section>

  <section class="features">
    <h2>Trois super-pouvoirs pour votre agence</h2>
    <div class="features-grid">
      <div class="feature-card fade-up-d1">
        <div class="feature-icon">üéØ</div>
        <h3>Matching intelligent</h3>
        <p>Notre IA analyse vos comp√©tences, r√©f√©rences et zone g√©ographique pour scorer chaque march√©. Fini les candidatures hors sujet.</p>
      </div>
      <div class="feature-card fade-up-d2">
        <div class="feature-icon">üìù</div>
        <h3>R√©daction assist√©e</h3>
        <p>Importez le DCE, AssistAO pr√©-remplit votre dossier de candidature avec vos r√©f√©rences les plus pertinentes. <em style="color:var(--text-dim)">(Phase 2)</em></p>
      </div>
      <div class="feature-card fade-up-d3">
        <div class="feature-icon">üë•</div>
        <h3>Constitution d'√©quipe</h3>
        <p>Besoin d'un BET structure ou fluides ? AssistAO sugg√®re les partenaires les plus compatibles avec le march√©. <em style="color:var(--text-dim)">(Phase 2)</em></p>
      </div>
    </div>
  </section>

  <div class="metrics fade-up">
    <div class="metric"><div class="metric-val">2 400+</div><div class="metric-label">March√©s MOE analys√©s / mois</div></div>
    <div class="metric"><div class="metric-val">+40%</div><div class="metric-label">Taux de r√©ussite moyen</div></div>
    <div class="metric"><div class="metric-val">8h</div><div class="metric-label">Gagn√©es par semaine</div></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- ONBOARDING -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-onboarding">
  <div class="onboarding">
    <!-- Steps indicator -->
    <div class="step-indicator">
      <div class="step-dot active" id="dot-1">1</div>
      <div class="step-line" id="line-1"></div>
      <div class="step-dot pending" id="dot-2">2</div>
      <div class="step-line" id="line-2"></div>
      <div class="step-dot pending" id="dot-3">3</div>
    </div>

    <!-- STEP 1 -->
    <div id="step-1">
      <h2>Inscription</h2>
      <div class="subtitle">Renseignez votre email et trouvez votre structure pour commencer.</div>

      <div class="form-group">
        <label class="form-label">Adresse email professionnelle</label>
        <input class="form-input" type="email" placeholder="vous@votreagence.fr" id="input-email" autocomplete="email" oninput="checkStep1Ready()">
        <div class="field-error" id="email-error"></div>
      </div>

      <div class="form-group" style="position:relative;">
        <label class="form-label">Nom ou num√©ro SIRET de votre structure</label>
        <input class="form-input" type="text" placeholder="Ex : Atelier Duval ou 842 567 391 00024" id="input-search" autocomplete="off" oninput="onSearchInput(this.value)">
        <div class="autocomplete-list" id="autocomplete-list"></div>
        <div class="field-error" id="structure-error"></div>
      </div>

      <button class="btn-block" onclick="startEnrichment()" id="btn-search" disabled>üîç Rechercher ma structure</button>

      <!-- Result ‚Äî rempli dynamiquement -->
      <div class="profile-result" id="profile-result" style="display:none;"></div>
    </div>

    <!-- STEP 2 -->
    <div id="step-2" style="display:none;">

      <!-- ‚îÄ‚îÄ COMP√âTENCES ‚îÄ‚îÄ -->
      <h2 style="margin-bottom:4px;">Comp√©tences</h2>
      <div class="subtitle" id="comp-subtitle">Ajoutez ou retirez les comp√©tences de votre structure.</div>

      <div id="comp-loading" style="display:none; text-align:center; padding:20px 0; color:var(--text-mid); font-size:13px;">
        <div style="font-size:20px; margin-bottom:6px;">‚è≥</div>Recherche des qualifications OPQIBI‚Ä¶
      </div>

      <div id="competences-list" class="comp-grid" style="margin-bottom:8px;"></div>

      <div style="display:flex; gap:8px; margin-bottom:28px;">
        <input type="text" id="input-add-comp" placeholder="Ajouter une comp√©tence‚Ä¶" style="flex:1; padding:8px 12px; border:1px solid var(--border); border-radius:8px; font-size:13px; background:var(--card);" onkeydown="if(event.key==='Enter'){addCompetence();}">
        <button onclick="addCompetence()" style="padding:8px 14px; background:var(--accent); color:#fff; border:none; border-radius:8px; font-size:13px; font-weight:600; cursor:pointer;">+ Ajouter</button>
      </div>

      <!-- ‚îÄ‚îÄ R√âF√âRENCES ‚îÄ‚îÄ -->
      <h2 style="margin-bottom:4px;">R√©f√©rences</h2>
      <div class="subtitle">March√©s publics remport√©s par votre structure <span style="font-size:11px; color:var(--text-light);">(source : DECP)</span></div>

      <div id="decp-loading" style="text-align:center; padding:30px 0; color:var(--text-mid); font-size:13px;">
        <div style="font-size:20px; margin-bottom:6px;">‚è≥</div>Recherche des march√©s publics‚Ä¶
      </div>

      <div id="decp-empty" style="display:none; text-align:center; padding:30px 0;">
        <div style="font-size:28px; margin-bottom:8px;">üì≠</div>
        <div style="font-size:14px; font-weight:600; color:var(--text); margin-bottom:4px;">Aucun march√© trouv√©</div>
        <div style="font-size:13px; color:var(--text-mid);">Votre structure n'appara√Æt pas dans les DECP. Vous pourrez ajouter vos r√©f√©rences manuellement.</div>
      </div>

      <div id="decp-results" style="display:none;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
          <div id="decp-count" style="font-size:13px; color:var(--text-mid);"></div>
          <label style="font-size:12px; color:var(--accent); cursor:pointer; font-weight:600;" onclick="toggleAllDecp()"><span id="toggle-all-label">Tout d√©s√©lectionner</span></label>
        </div>
        <div id="decp-list"></div>
      </div>

      <button class="btn-block" style="margin-top:20px;" onclick="goToStep(3)">Continuer ‚Üí</button>
    </div>

    <!-- STEP 3 -->
    <div id="step-3" style="display:none;">
      <h2>Pr√©f√©rences march√©s</h2>
      <div class="subtitle">Personnalisez vos recommandations et alertes.</div>

      <div class="pref-row">
        <div><div class="pref-label">Montant minimum</div><div class="pref-desc">Ignorer les march√©s en dessous</div></div>
        <select class="pref-select"><option>Pas de minimum</option><option>100 000 ‚Ç¨</option><option selected>500 000 ‚Ç¨</option><option>1 000 000 ‚Ç¨</option><option>2 000 000 ‚Ç¨</option></select>
      </div>
      <div class="pref-row">
        <div><div class="pref-label">Montant maximum</div><div class="pref-desc">Ignorer les march√©s au-dessus</div></div>
        <select class="pref-select"><option>Pas de maximum</option><option>2 000 000 ‚Ç¨</option><option>5 000 000 ‚Ç¨</option><option selected>10 000 000 ‚Ç¨</option><option>20 000 000 ‚Ç¨</option></select>
      </div>
      <div class="pref-row">
        <div><div class="pref-label">Rayon de recherche</div><div class="pref-desc">Zone g√©ographique d'intervention</div></div>
        <select class="pref-select"><option>D√©partement</option><option selected>R√©gion</option><option>National</option><option>International</option></select>
      </div>
      <div class="pref-row">
        <div><div class="pref-label">Score minimum</div><div class="pref-desc">Seuil de pertinence pour les alertes</div></div>
        <select class="pref-select"><option>50%</option><option>60%</option><option selected>70%</option><option>80%</option><option>90%</option></select>
      </div>

      <button class="btn-block" style="margin-top:24px;" onclick="showPage('dashboard')">üöÄ Voir mes march√©s recommand√©s</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- DASHBOARD -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-dashboard">
  <div class="dash">
    <div class="dash-header">
      <div>
        <h1>AssistAO</h1>
        <p>Bonjour Marie ‚Äî votre assistant appels d'offres.</p>
      </div>
    </div>

    <!-- 3 onglets -->
    <div class="dash-tabs">
      <button class="dash-tab active" onclick="switchTab('marche', this)"><span class="tab-icon">üéØ</span>Matching March√©</button>
      <button class="dash-tab" onclick="switchTab('equipe', this)"><span class="tab-icon">üë•</span>Matching √âquipe</button>
      <button class="dash-tab" onclick="switchTab('redaction', this)"><span class="tab-icon">‚úçÔ∏è</span>R√©daction</button>
    </div>

    <!-- ‚ïê‚ïê‚ïê TAB 1 : MATCHING MARCH√â ‚ïê‚ïê‚ïê -->
    <div class="dash-tab-content active" id="tab-marche">
      <div class="stats-bar">
        <div class="stat-card"><div class="stat-val" style="color:var(--accent)">7</div><div class="stat-label">March√©s cette semaine</div></div>
        <div class="stat-card"><div class="stat-val" style="color:var(--green)">83%</div><div class="stat-label">Score moyen</div></div>
        <div class="stat-card"><div class="stat-val" style="color:var(--blue)">2</div><div class="stat-label">Dossiers en cours</div></div>
        <div class="stat-card"><div class="stat-val" style="color:#DC2626">3j</div><div class="stat-label">Prochaine date limite</div></div>
      </div>

      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:14px;">
        <div class="dash-filters">
          <button class="filter-btn active">Tous</button>
          <button class="filter-btn" onclick="this.classList.toggle('active')">√âducation</button>
          <button class="filter-btn" onclick="this.classList.toggle('active')">Culture</button>
          <button class="filter-btn" onclick="this.classList.toggle('active')">Logement</button>
        </div>
      </div>

      <div class="marche-list">
        <div class="marche-card new" onclick="showPage('detail')">
          <div class="marche-score score-green"><div class="score-num">94%</div><div class="score-label">match</div></div>
          <div class="marche-body">
            <h3>Restructuration et extension du groupe scolaire Victor Hugo ‚Äî 12 classes</h3>
            <div class="marche-meta">üèõÔ∏è Ville de Bordeaux ¬∑ üìç Bordeaux, Gironde ¬∑ MOE</div>
            <div class="marche-tags"><span class="tag tag-domain">√âducation</span><span class="tag tag-type">R√©habilitation</span><span class="tag tag-top">‚≠ê Top match</span></div>
            <div class="marche-ai"><strong>ü§ñ Pourquoi ce march√© :</strong> 3 r√©f√©rences scolaires similaires (dont Jean Moulin 2023, 4.2M‚Ç¨). Zone Nouvelle-Aquitaine couverte. Montant dans votre fourchette habituelle.</div>
          </div>
          <div class="marche-right"><div class="marche-amount">5.8 M‚Ç¨</div><div class="marche-deadline urgent">‚è∞ 15/04/2026</div></div>
        </div>

        <div class="marche-card new" onclick="showPage('detail')">
          <div class="marche-score score-green"><div class="score-num">87%</div><div class="score-label">match</div></div>
          <div class="marche-body">
            <h3>Construction d'une m√©diath√®que intercommunale ‚Äî 1 800 m¬≤ SHON</h3>
            <div class="marche-meta">üèõÔ∏è CC Pays de Retz ¬∑ üìç Pornic, Loire-Atlantique ¬∑ MOE</div>
            <div class="marche-tags"><span class="tag tag-domain">Culture</span><span class="tag tag-type">Neuf</span></div>
            <div class="marche-ai"><strong>ü§ñ Pourquoi ce march√© :</strong> R√©f√©rence m√©diath√®que H√©l√®ne Berr (2022, m√™me programme). Proximit√© g√©ographique (65 km). Comp√©tence HQE pertinente.</div>
          </div>
          <div class="marche-right"><div class="marche-amount">3.2 M‚Ç¨</div><div class="marche-deadline">‚è∞ 22/04/2026</div></div>
        </div>

        <div class="marche-card" onclick="showPage('detail')">
          <div class="marche-score score-green"><div class="score-num">82%</div><div class="score-label">match</div></div>
          <div class="marche-body">
            <h3>R√©habilitation √©nerg√©tique EHPAD Les Glycines ‚Äî 80 lits</h3>
            <div class="marche-meta">üèõÔ∏è D√©partement du Finist√®re ¬∑ üìç Quimper ¬∑ MOE</div>
            <div class="marche-tags"><span class="tag tag-domain">Sant√©</span><span class="tag tag-type">R√©habilitation</span></div>
            <div class="marche-ai"><strong>ü§ñ Pourquoi ce march√© :</strong> Expertise r√©habilitation confirm√©e. Comp√©tence HQE/performance √©nerg√©tique. Distance 250 km (dans votre rayon r√©gion).</div>
          </div>
          <div class="marche-right"><div class="marche-amount">2.4 M‚Ç¨</div><div class="marche-deadline">‚è∞ 08/04/2026</div></div>
        </div>

        <div class="marche-card" onclick="showPage('detail')">
          <div class="marche-score score-yellow"><div class="score-num">76%</div><div class="score-label">match</div></div>
          <div class="marche-body">
            <h3>Construction de 48 logements collectifs BBC ‚Äî ZAC des Perri√®res</h3>
            <div class="marche-meta">üèõÔ∏è Nantes M√©tropole Habitat ¬∑ üìç Rez√©, Loire-Atlantique ¬∑ MOE</div>
            <div class="marche-tags"><span class="tag tag-domain">Logement</span><span class="tag tag-type">Neuf</span></div>
            <div class="marche-ai"><strong>ü§ñ Pourquoi ce march√© :</strong> R√©f√©rence ZAC Prairie au Duc (56 logements, 2020). Tr√®s proche g√©ographiquement (8 km). Programme l√©g√®rement diff√©rent.</div>
          </div>
          <div class="marche-right"><div class="marche-amount">4.1 M‚Ç¨</div><div class="marche-deadline">‚è∞ 30/04/2026</div></div>
        </div>

        <div class="marche-card" onclick="showPage('detail')">
          <div class="marche-score score-yellow"><div class="score-num">71%</div><div class="score-label">match</div></div>
          <div class="marche-body">
            <h3>Concours de MOE ‚Äî P√¥le petite enfance multi-accueil 60 berceaux</h3>
            <div class="marche-meta">üèõÔ∏è Ville de Saint-Nazaire ¬∑ üìç Saint-Nazaire, Loire-Atlantique ¬∑ Concours</div>
            <div class="marche-tags"><span class="tag tag-domain">Petite enfance</span><span class="tag tag-type">Concours</span></div>
            <div class="marche-ai"><strong>ü§ñ Pourquoi ce march√© :</strong> Proximit√© g√©ographique (60 km). Comp√©tence construction neuve. ‚ö† Pas de r√©f√©rence petite enfance directe.</div>
          </div>
          <div class="marche-right"><div class="marche-amount">1.9 M‚Ç¨</div><div class="marche-deadline">‚è∞ 12/05/2026</div></div>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê TAB 2 : MATCHING √âQUIPE ‚ïê‚ïê‚ïê -->
    <div class="dash-tab-content" id="tab-equipe">
      <div class="stats-bar">
        <div class="stat-card"><div class="stat-val" style="color:var(--accent)">12</div><div class="stat-label">Partenaires dans le r√©seau</div></div>
        <div class="stat-card"><div class="stat-val" style="color:var(--green)">5</div><div class="stat-label">Collaborations pass√©es</div></div>
        <div class="stat-card"><div class="stat-val" style="color:var(--blue)">3</div><div class="stat-label">√âquipes sugg√©r√©es</div></div>
        <div class="stat-card"><div class="stat-val" style="color:var(--purple)">8</div><div class="stat-label">Comp√©tences couvertes</div></div>
      </div>

      <p style="font-size:13px; color:var(--text-mid); margin-bottom:18px;">S√©lectionnez un march√© pour voir l'√©quipe optimale sugg√©r√©e par l'IA, bas√©e sur les comp√©tences requises, vos collaborations pass√©es et la disponibilit√©.</p>

      <!-- Equipe pour Victor Hugo -->
      <div style="background:white; border:1px solid var(--border); border-radius:14px; padding:24px; margin-bottom:16px;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
          <div>
            <h3 style="font-size:15px; font-weight:700; margin-bottom:2px;">Groupe scolaire Victor Hugo ‚Äî Bordeaux</h3>
            <span style="font-size:12px; color:var(--text-mid);">5.8 M‚Ç¨ ¬∑ MOE compl√®te ¬∑ Date limite 15/04/2026</span>
          </div>
          <span class="tag tag-top">94% match</span>
        </div>
        <div style="font-size:13px; color:var(--text-mid); margin-bottom:14px; padding:10px 14px; background:#F9F7F4; border-radius:8px;">
          <strong style="color:var(--text);">ü§ñ Recommandation IA :</strong> Ce march√© n√©cessite des comp√©tences en structure b√©ton, CVC et √©conomie de la construction. L'√©quipe ci-dessous a d√©j√† collabor√© sur 2 projets similaires et couvre 100% des lots.
        </div>
        <div class="team-member">
          <div class="team-avatar" style="background:var(--accent-light); color:var(--accent);">BS</div>
          <div class="team-info"><div class="name">BET Soulier</div><div class="role">Structure b√©ton ¬∑ 3 collabs pass√©es</div></div>
          <div style="display:flex; align-items:center; gap:8px;"><div class="team-score">91%</div><span style="font-size:11px; color:var(--text-dim);">match</span></div>
        </div>
        <div class="team-member">
          <div class="team-avatar" style="background:rgba(74,144,217,0.1); color:var(--blue);">TF</div>
          <div class="team-info"><div class="name">Thermibat Fluides</div><div class="role">CVC / Plomberie ¬∑ 2 collabs pass√©es</div></div>
          <div style="display:flex; align-items:center; gap:8px;"><div class="team-score">87%</div><span style="font-size:11px; color:var(--text-dim);">match</span></div>
        </div>
        <div class="team-member">
          <div class="team-avatar" style="background:rgba(139,92,246,0.1); color:var(--purple);">EC</div>
          <div class="team-info"><div class="name">√âco-Conseil 44</div><div class="role">√âconomiste ¬∑ 1 collab pass√©e</div></div>
          <div style="display:flex; align-items:center; gap:8px;"><div class="team-score">84%</div><span style="font-size:11px; color:var(--text-dim);">match</span></div>
        </div>
        <div class="team-member">
          <div class="team-avatar" style="background:rgba(16,185,129,0.1); color:var(--green);">PA</div>
          <div class="team-info"><div class="name">Paysage Atlantique</div><div class="role">Paysagiste ¬∑ Nouveau partenaire sugg√©r√©</div></div>
          <div style="display:flex; align-items:center; gap:8px;"><div class="team-score">78%</div><span style="font-size:11px; color:var(--text-dim);">match</span></div>
        </div>
        <button class="btn-sidebar primary" style="margin-top:14px;">‚úâÔ∏è Contacter l'√©quipe</button>
      </div>

      <!-- Equipe pour M√©diath√®que -->
      <div style="background:white; border:1px solid var(--border); border-radius:14px; padding:24px;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
          <div>
            <h3 style="font-size:15px; font-weight:700; margin-bottom:2px;">M√©diath√®que intercommunale ‚Äî Pornic</h3>
            <span style="font-size:12px; color:var(--text-mid);">3.2 M‚Ç¨ ¬∑ MOE compl√®te ¬∑ Date limite 22/04/2026</span>
          </div>
          <span class="tag tag-top">87% match</span>
        </div>
        <div style="font-size:13px; color:var(--text-mid); margin-bottom:14px; padding:10px 14px; background:#F9F7F4; border-radius:8px;">
          <strong style="color:var(--text);">ü§ñ Recommandation IA :</strong> Programme culturel avec exigences acoustiques et sc√©nographiques. Suggestion d'un acousticien sp√©cialis√© ERP + un BET g√©n√©raliste local.
        </div>
        <div class="team-member">
          <div class="team-avatar" style="background:var(--accent-light); color:var(--accent);">BS</div>
          <div class="team-info"><div class="name">BET Soulier</div><div class="role">Structure ¬∑ R√©f√©rence biblioth√®que 2021</div></div>
          <div style="display:flex; align-items:center; gap:8px;"><div class="team-score">89%</div><span style="font-size:11px; color:var(--text-dim);">match</span></div>
        </div>
        <div class="team-member">
          <div class="team-avatar" style="background:rgba(245,158,11,0.1); color:var(--yellow);">AA</div>
          <div class="team-info"><div class="name">Avel Acoustique</div><div class="role">Acousticien ¬∑ Sp√©cialiste ERP culturel</div></div>
          <div style="display:flex; align-items:center; gap:8px;"><div class="team-score">92%</div><span style="font-size:11px; color:var(--text-dim);">match</span></div>
        </div>
        <div class="team-member">
          <div class="team-avatar" style="background:rgba(74,144,217,0.1); color:var(--blue);">TF</div>
          <div class="team-info"><div class="name">Thermibat Fluides</div><div class="role">CVC / Plomberie</div></div>
          <div style="display:flex; align-items:center; gap:8px;"><div class="team-score">85%</div><span style="font-size:11px; color:var(--text-dim);">match</span></div>
        </div>
        <button class="btn-sidebar primary" style="margin-top:14px;">‚úâÔ∏è Contacter l'√©quipe</button>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê TAB 3 : R√âDACTION ‚ïê‚ïê‚ïê -->
    <div class="dash-tab-content" id="tab-redaction">
      <div class="stats-bar">
        <div class="stat-card"><div class="stat-val" style="color:var(--accent)">2</div><div class="stat-label">Dossiers en cours</div></div>
        <div class="stat-card"><div class="stat-val" style="color:var(--green)">1</div><div class="stat-label">Dossier finalis√©</div></div>
        <div class="stat-card"><div class="stat-val" style="color:var(--blue)">6</div><div class="stat-label">Pi√®ces g√©n√©r√©es</div></div>
        <div class="stat-card"><div class="stat-val" style="color:#DC2626">3j</div><div class="stat-label">Prochaine date limite</div></div>
      </div>

      <p style="font-size:13px; color:var(--text-mid); margin-bottom:18px;">L'IA vous assiste dans la r√©daction des pi√®ces de candidature et d'offre. S√©lectionnez un march√© pour g√©n√©rer vos documents.</p>

      <!-- Dossier Victor Hugo -->
      <div style="background:white; border:1px solid var(--border); border-radius:14px; padding:24px; margin-bottom:16px;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
          <div>
            <h3 style="font-size:15px; font-weight:700; margin-bottom:2px;">Groupe scolaire Victor Hugo ‚Äî Bordeaux</h3>
            <span style="font-size:12px; color:var(--text-mid);">Date limite 15/04/2026 ¬∑ <span style="color:#DC2626; font-weight:600;">3 jours restants</span></span>
          </div>
          <span style="font-size:11px; font-weight:700; padding:4px 10px; border-radius:20px; background:rgba(245,158,11,0.1); color:var(--yellow);">En cours</span>
        </div>

        <div style="display:flex; flex-direction:column; gap:10px;">
          <div style="display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border:1px solid var(--border); border-radius:10px;">
            <div style="display:flex; align-items:center; gap:10px;">
              <span style="font-size:18px;">üìÑ</span>
              <div><div style="font-size:13px; font-weight:600;">Lettre de candidature (DC1)</div><div style="font-size:11px; color:var(--text-mid);">Formulaire pr√©-rempli avec vos informations</div></div>
            </div>
            <span style="font-size:11px; font-weight:700; color:var(--green);">‚úì G√©n√©r√©</span>
          </div>

          <div style="display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border:1px solid var(--border); border-radius:10px;">
            <div style="display:flex; align-items:center; gap:10px;">
              <span style="font-size:18px;">üìÑ</span>
              <div><div style="font-size:13px; font-weight:600;">D√©claration du candidat (DC2)</div><div style="font-size:11px; color:var(--text-mid);">Chiffres cl√©s et capacit√©s pr√©-remplis</div></div>
            </div>
            <span style="font-size:11px; font-weight:700; color:var(--green);">‚úì G√©n√©r√©</span>
          </div>

          <div style="display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border:1px solid var(--border); border-radius:10px;">
            <div style="display:flex; align-items:center; gap:10px;">
              <span style="font-size:18px;">üìù</span>
              <div><div style="font-size:13px; font-weight:600;">M√©moire technique</div><div style="font-size:11px; color:var(--text-mid);">M√©thodologie, r√©f√©rences, moyens humains</div></div>
            </div>
            <span style="font-size:11px; font-weight:700; color:var(--yellow);">‚è≥ Brouillon</span>
          </div>

          <div style="display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border:1px solid var(--border); border-radius:10px;">
            <div style="display:flex; align-items:center; gap:10px;">
              <span style="font-size:18px;">üìä</span>
              <div><div style="font-size:13px; font-weight:600;">Fiches de r√©f√©rences</div><div style="font-size:11px; color:var(--text-mid);">3 r√©f√©rences s√©lectionn√©es, mises en page</div></div>
            </div>
            <span style="font-size:11px; font-weight:700; color:var(--green);">‚úì G√©n√©r√©</span>
          </div>

          <div style="display:flex; align-items:center; justify-content:space-between; padding:12px 16px; border:1px solid var(--border); border-radius:10px; background:#F9F7F4;">
            <div style="display:flex; align-items:center; gap:10px;">
              <span style="font-size:18px;">üìé</span>
              <div><div style="font-size:13px; font-weight:600;">Attestations & certificats</div><div style="font-size:11px; color:var(--text-mid);">Assurance, KBIS, attestation fiscale‚Ä¶</div></div>
            </div>
            <span style="font-size:11px; font-weight:700; color:var(--text-dim);">√Ä compl√©ter</span>
          </div>
        </div>

        <div style="display:flex; gap:10px; margin-top:14px;">
          <button class="btn-sidebar primary" style="flex:1;">‚úçÔ∏è Continuer la r√©daction</button>
          <button class="btn-sidebar secondary" style="flex:1;">üì¶ Exporter le dossier</button>
        </div>
      </div>

      <!-- Dossier M√©diath√®que -->
      <div style="background:white; border:1px solid var(--border); border-radius:14px; padding:24px;">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px;">
          <div>
            <h3 style="font-size:15px; font-weight:700; margin-bottom:2px;">M√©diath√®que intercommunale ‚Äî Pornic</h3>
            <span style="font-size:12px; color:var(--text-mid);">Date limite 22/04/2026 ¬∑ 10 jours restants</span>
          </div>
          <span style="font-size:11px; font-weight:700; padding:4px 10px; border-radius:20px; background:rgba(74,144,217,0.1); color:var(--blue);">Nouveau</span>
        </div>

        <div style="font-size:13px; color:var(--text-mid); margin-bottom:14px; padding:10px 14px; background:#F9F7F4; border-radius:8px;">
          <strong style="color:var(--text);">ü§ñ Analyse du RC :</strong> Candidature en 2 phases. Phase 1 : dossier de comp√©tences + 3 r√©f√©rences max. Phase 2 : offre technique et financi√®re sur invitation. Pi√®ces requises : DC1, DC2, m√©moire de comp√©tences, r√©f√©rences illustr√©es.
        </div>

        <div style="display:flex; gap:10px;">
          <button class="btn-sidebar primary" style="flex:1;">üöÄ D√©marrer la r√©daction</button>
          <button class="btn-sidebar secondary" style="flex:1;">üìã Voir le RC</button>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- DETAIL PAGE -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-detail">
  <div class="detail">
    <button class="detail-back" onclick="showPage('dashboard')">‚Üê Retour aux march√©s</button>

    <div class="detail-grid">
      <div class="detail-main">
        <div style="display:flex; gap:10px; margin-bottom:14px;">
          <span class="tag tag-domain">√âducation</span>
          <span class="tag tag-type">R√©habilitation + Extension</span>
          <span class="tag tag-top">‚≠ê Top match</span>
        </div>
        <h1>Restructuration et extension du groupe scolaire Victor Hugo ‚Äî 12 classes</h1>
        <div class="meta-row">
          <span>üèõÔ∏è Ville de Bordeaux</span>
          <span>üìç Bordeaux, Gironde</span>
          <span>üìã MOE compl√®te</span>
        </div>

        <!-- Score breakdown -->
        <div class="detail-score-bar">
          <div class="score-pill main"><div class="pill-val">94%</div><div class="pill-label">Score total</div></div>
          <div class="score-pill"><div class="pill-val" style="color:var(--accent)">92%</div><div class="pill-label">S√©mantique</div></div>
          <div class="score-pill"><div class="pill-val" style="color:var(--blue)">100%</div><div class="pill-label">Domaine</div></div>
          <div class="score-pill"><div class="pill-val" style="color:var(--green)">88%</div><div class="pill-label">R√©f√©rences</div></div>
          <div class="score-pill"><div class="pill-val" style="color:var(--yellow)">65%</div><div class="pill-label">G√©o</div></div>
          <div class="score-pill"><div class="pill-val" style="color:var(--purple)">85%</div><div class="pill-label">Montant</div></div>
        </div>

        <!-- AI Analysis -->
        <div class="detail-section">
          <h3>ü§ñ Analyse IA ‚Äî Pourquoi ce march√© vous correspond</h3>
          <div class="ai-reasons">
            <div class="ai-reason"><div class="icon">üìã</div><div>Vous avez <strong>3 r√©f√©rences scolaires</strong> directement similaires, dont le groupe scolaire Jean Moulin (2023, 4.2M‚Ç¨) avec un programme quasi identique (8‚Üí12 classes, r√©habilitation + extension).</div></div>
            <div class="ai-reason"><div class="icon">üèóÔ∏è</div><div>Votre expertise en <strong>r√©habilitation</strong> et <strong>performance √©nerg√©tique (HQE)</strong> correspond parfaitement aux exigences du DCE qui mentionne une cible RE2020 et la r√©habilitation thermique de l'existant.</div></div>
            <div class="ai-reason"><div class="icon">üí∞</div><div>Le montant estim√© de <strong>5.8M‚Ç¨</strong> est dans votre fourchette haute (max historique : 6.1M‚Ç¨ pour Jules Verne) ‚Äî calibre accessible mais ambitieux.</div></div>
            <div class="ai-reason"><div class="icon">‚ö†Ô∏è</div><div><strong>Point de vigilance :</strong> localisation √† Bordeaux (340 km). Pas de r√©f√©rence en Nouvelle-Aquitaine. Pensez √† mentionner votre capacit√© de d√©placement ou un partenaire local.</div></div>
          </div>
        </div>

        <!-- Object -->
        <div class="detail-section">
          <h3>üìÑ Objet du march√©</h3>
          <p style="font-size:13px; color:var(--text-mid); line-height:1.6;">
            Mission de ma√Ætrise d'≈ìuvre compl√®te (ESQ √† AOR) pour la restructuration et l'extension du groupe scolaire Victor Hugo, situ√© quartier Bastide √† Bordeaux. Le programme comprend la r√©habilitation thermique du b√¢timent existant (1965, R+2, 2 400 m¬≤), l'extension pour 4 classes suppl√©mentaires (~600 m¬≤), la mise aux normes accessibilit√©, la cr√©ation d'un p√¥le restauration (300 couverts), et l'am√©nagement des espaces ext√©rieurs. Cible RE2020, label E3C1 minimum. D√©marrage √©tudes : septembre 2026. Livraison pr√©visionnelle : rentr√©e 2029.
          </p>
        </div>
      </div>

      <!-- Sidebar -->
      <div class="detail-sidebar">
        <div class="sidebar-card">
          <h4>Informations cl√©s</h4>
          <div class="sidebar-row"><span class="label">Date limite</span><span class="val" style="color:#DC2626">15/04/2026</span></div>
          <div class="sidebar-row"><span class="label">Montant estim√©</span><span class="val">5 800 000 ‚Ç¨ HT</span></div>
          <div class="sidebar-row"><span class="label">Type</span><span class="val">MOE compl√®te</span></div>
          <div class="sidebar-row"><span class="label">Proc√©dure</span><span class="val">Appel d'offres restreint</span></div>
          <div class="sidebar-row"><span class="label">Lieu</span><span class="val">Bordeaux (33)</span></div>
          <div class="sidebar-row"><span class="label">Source</span><span class="val">BOAMP</span></div>
          <button class="btn-sidebar primary">üìÑ Pr√©parer le dossier ‚Üí</button>
          <button class="btn-sidebar secondary">üíæ Sauvegarder</button>
        </div>

        <div class="sidebar-card">
          <h4>√âquipe sugg√©r√©e (phase 2)</h4>
          <div class="team-member">
            <div class="team-avatar">BS</div>
            <div class="team-info"><div class="name">BET Soulier</div><div class="role">Structure b√©ton</div></div>
            <div class="team-score">91%</div>
          </div>
          <div class="team-member">
            <div class="team-avatar">TF</div>
            <div class="team-info"><div class="name">Thermibat Fluides</div><div class="role">CVC / Plomberie</div></div>
            <div class="team-score">87%</div>
          </div>
          <div class="team-member">
            <div class="team-avatar">EC</div>
            <div class="team-info"><div class="name">√âco-Conseil 44</div><div class="role">√âconomiste</div></div>
            <div class="team-score">84%</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ‚îÄ‚îÄ Page navigation ‚îÄ‚îÄ
function switchTab(tabId, btn) {
  document.querySelectorAll('.dash-tab').forEach(function(t) { t.classList.remove('active'); });
  document.querySelectorAll('.dash-tab-content').forEach(function(c) { c.classList.remove('active'); });
  btn.classList.add('active');
  document.getElementById('tab-' + tabId).classList.add('active');
}

function showPage(id) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + id).classList.add('active');
  window.scrollTo({ top: 0, behavior: 'smooth' });
  // Update nav
  const links = document.getElementById('navLinks');
  if (id === 'dashboard' || id === 'detail') {
    links.innerHTML = `
      <a href="#" onclick="showPage('dashboard'); return false;" style="color:var(--accent); font-weight:700;">Dashboard</a>
      <a href="#" onclick="return false;">Profil</a>
      <button class="btn-outline" onclick="showPage('landing')">D√©connexion</button>
    `;
  } else if (id === 'landing') {
    links.innerHTML = `
      <button class="btn-outline" onclick="showPage('onboarding')">Connexion</button>
      <button class="btn-primary" onclick="showPage('onboarding')">Inscription</button>
    `;
  }
}

// ‚îÄ‚îÄ Autocomplete ‚Äî API Recherche Entreprises (data.gouv.fr) ‚îÄ‚îÄ
let selectedStructure = null;
let currentMatches = [];
let searchTimeout = null;

function escapeHtml(str) {
  if (!str) return '';
  return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

function onSearchInput(val) {
  const list = document.getElementById('autocomplete-list');
  const trimmed = val.trim();

  selectedStructure = null;
  document.getElementById('structure-error').textContent = '';
  document.getElementById('input-search').classList.remove('input-error', 'input-ok');
  checkStep1Ready();

  if (searchTimeout) clearTimeout(searchTimeout);

  if (trimmed.length < 2) {
    list.classList.remove('show');
    list.innerHTML = '';
    currentMatches = [];
    return;
  }

  list.innerHTML = '<div class="autocomplete-hint">Recherche en cours‚Ä¶</div>';
  list.classList.add('show');

  // Debounce 300ms pour ne pas spammer l'API
  searchTimeout = setTimeout(function() { searchAPI(trimmed); }, 300);
}

function searchAPI(query) {
  const list = document.getElementById('autocomplete-list');
  var url = 'https://recherche-entreprises.api.gouv.fr/search?q=' + encodeURIComponent(query) + '&per_page=6&page=1';

  fetch(url)
    .then(function(r) { return r.json(); })
    .then(function(data) {
      if (!data.results || data.results.length === 0) {
        list.innerHTML = '<div class="autocomplete-hint">Aucune structure trouv√©e ‚Äî v√©rifiez le nom ou le SIRET</div>';
        currentMatches = [];
        return;
      }

      currentMatches = data.results.map(function(r) {
        var siege = r.siege || {};
        var dirigeants = r.dirigeants || [];
        var dir = dirigeants.length > 0 ? dirigeants[0] : null;
        var cp = siege.code_postal || '';
        var ville = siege.libelle_commune || '';
        var dep = cp.substring(0, 2);
        return {
          nom: r.nom_complet || r.nom_raison_sociale || '',
          siren: r.siren || '',
          siret: siege.siret || '',
          activite_code: r.activite_principale || '',
          activite_label: r.libelle_activite_principale || '',
          adresse: siege.geo_adresse || '',
          code_postal: cp,
          ville: ville,
          departement: dep,
          ville_display: ville + (dep ? ' (' + dep + ')' : ''),
          effectif: r.tranche_effectif_salarie || 'Non renseign√©',
          date_creation: r.date_creation || '',
          dirigeant_nom: dir ? ((dir.prenom || '') + ' ' + (dir.nom || '')).trim() : '',
          dirigeant_qualite: dir ? (dir.qualite || '') : '',
          nature_juridique: r.nature_juridique || '',
          categorie_juridique: r.categorie_juridique || ''
        };
      });

      var html = '';
      var queryLower = query.toLowerCase();
      for (var i = 0; i < currentMatches.length; i++) {
        var s = currentMatches[i];
        var displayName = escapeHtml(s.nom);
        var lo = s.nom.toLowerCase().indexOf(queryLower);
        if (lo !== -1) {
          displayName = escapeHtml(s.nom.substring(0, lo)) +
                        '<span class="ac-highlight">' + escapeHtml(s.nom.substring(lo, lo + query.length)) + '</span>' +
                        escapeHtml(s.nom.substring(lo + query.length));
        }
        var meta = escapeHtml(s.siret || s.siren) + ' ¬∑ ' + escapeHtml(s.ville_display);
        if (s.activite_label) meta += ' ¬∑ ' + escapeHtml(s.activite_label);
        html += '<div class="autocomplete-item" data-idx="' + i + '">' +
          '<div class="ac-name">' + displayName + '</div>' +
          '<div class="ac-meta">' + meta + '</div>' +
        '</div>';
      }
      list.innerHTML = html;
    })
    .catch(function(err) {
      console.error('API error:', err);
      list.innerHTML = '<div class="autocomplete-hint">Erreur de connexion ‚Äî r√©essayez</div>';
      currentMatches = [];
    });
}

// Delegate click on autocomplete items
document.addEventListener('click', function(e) {
  var item = e.target.closest('.autocomplete-item');
  if (item) {
    var idx = parseInt(item.getAttribute('data-idx'), 10);
    var s = currentMatches[idx];
    if (s) {
      selectedStructure = s;
      document.getElementById('input-search').value = s.nom;
      document.getElementById('autocomplete-list').classList.remove('show');
      document.getElementById('structure-error').textContent = '';
      document.getElementById('input-search').classList.remove('input-error');
      checkStep1Ready();
    }
    return;
  }
  if (!e.target.closest('.form-group')) {
    document.getElementById('autocomplete-list').classList.remove('show');
  }
});

// ‚îÄ‚îÄ Validation step 1 ‚îÄ‚îÄ
// Simulated already-registered data (in prod: API calls to your backend)
var registeredEmails = ['marie.duval@atelier-duval.fr', 'contact@archipole.fr', 'test@test.com'];
var registeredSirens = ['432109876']; // Archipole for demo purposes

function isValidEmail(email) {
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

function checkStep1Ready() {
  var email = document.getElementById('input-email').value.trim();
  var emailInput = document.getElementById('input-email');
  var emailError = document.getElementById('email-error');
  var btn = document.getElementById('btn-search');

  // Reset email state
  emailInput.classList.remove('input-error', 'input-ok');
  emailError.textContent = '';

  var emailOk = false;
  if (email.length === 0) {
    emailOk = false;
  } else if (!isValidEmail(email)) {
    emailInput.classList.add('input-error');
    emailError.textContent = 'Adresse email invalide';
  } else if (registeredEmails.indexOf(email.toLowerCase()) !== -1) {
    emailInput.classList.add('input-error');
    emailError.textContent = 'Cette adresse est d√©j√† associ√©e √† un compte. Connectez-vous ou utilisez une autre adresse.';
  } else {
    emailInput.classList.add('input-ok');
    emailOk = true;
  }

  btn.disabled = !(emailOk && selectedStructure);
}

// ‚îÄ‚îÄ Onboarding enrichment ‚îÄ‚îÄ
function startEnrichment() {
  if (!selectedStructure) return;

  // Check email one more time
  var email = document.getElementById('input-email').value.trim();
  if (!isValidEmail(email)) return;
  if (registeredEmails.indexOf(email.toLowerCase()) !== -1) {
    checkStep1Ready();
    return;
  }

  // Check if structure is already registered
  var structError = document.getElementById('structure-error');
  var searchInput = document.getElementById('input-search');
  if (registeredSirens.indexOf(selectedStructure.siren) !== -1) {
    structError.textContent = 'Cette structure est d√©j√† inscrite sur AssistAO. Connectez-vous avec l\'email associ√©.';
    searchInput.classList.add('input-error');
    return;
  }

  const btn = document.getElementById('btn-search');
  btn.disabled = true;
  btn.textContent = 'Recherche en cours...';
  searchInput.disabled = true;
  document.getElementById('input-email').disabled = true;
  document.getElementById('profile-result').style.display = 'none';

  setTimeout(() => {
    var s = selectedStructure;
    var activite = s.activite_code ? (s.activite_code + ' ‚Äî ' + s.activite_label) : (s.activite_label || 'Non renseign√©');
    var dirigeant = s.dirigeant_nom ? (s.dirigeant_nom + (s.dirigeant_qualite ? ' (' + s.dirigeant_qualite + ')' : '')) : 'Non renseign√©';
    var dateCreation = s.date_creation ? new Date(s.date_creation).toLocaleDateString('fr-FR', { day: 'numeric', month: 'long', year: 'numeric' }) : 'Non renseign√©e';
    var adresse = s.adresse || 'Non renseign√©e';

    document.getElementById('profile-result').innerHTML =
      '<div style="display:flex; justify-content:space-between; align-items:center;">' +
        '<div>' +
          '<h3>' + escapeHtml(s.nom) + '</h3>' +
          '<div style="font-size:13px; color:var(--text-mid);">SIRET ' + escapeHtml(s.siret || s.siren) + '</div>' +
        '</div>' +
        '<div class="badge-green">‚úì V√©rifi√©</div>' +
      '</div>' +
      '<div class="profile-grid">' +
        '<div class="profile-field"><div class="label">Adresse</div><div class="value">' + escapeHtml(adresse) + '</div></div>' +
        '<div class="profile-field"><div class="label">Activit√© (NAF)</div><div class="value">' + escapeHtml(activite) + '</div></div>' +
        '<div class="profile-field"><div class="label">Effectif</div><div class="value">' + escapeHtml(s.effectif) + '</div></div>' +
        '<div class="profile-field"><div class="label">Dirigeant</div><div class="value">' + escapeHtml(dirigeant) + '</div></div>' +
        '<div class="profile-field"><div class="label">Cr√©ation</div><div class="value">' + escapeHtml(dateCreation) + '</div></div>' +
        '<div class="profile-field"><div class="label">Commune</div><div class="value">' + escapeHtml(s.ville_display) + '</div></div>' +
      '</div>' +
      '<div style="margin-top:16px;">' +
        '<button class="btn-block" onclick="goToStep(2)">C\'est bien ma structure ‚Äî Continuer ‚Üí</button>' +
      '</div>';

    document.getElementById('profile-result').style.display = 'block';
    document.getElementById('profile-result').classList.add('fade-up');
    btn.style.display = 'none';
  }, 800);
}

// ‚îÄ‚îÄ Step navigation ‚îÄ‚îÄ
function goToStep(step) {
  for (let i = 1; i <= 3; i++) {
    document.getElementById('step-' + i).style.display = 'none';
  }
  document.getElementById('step-' + step).style.display = 'block';
  document.getElementById('step-' + step).classList.add('fade-in');

  for (let i = 1; i <= 3; i++) {
    const dot = document.getElementById('dot-' + i);
    dot.classList.remove('active', 'done', 'pending');
    if (i < step) { dot.classList.add('done'); dot.textContent = '‚úì'; }
    else if (i === step) dot.classList.add('active');
    else dot.classList.add('pending');
    if (i < 3) {
      const line = document.getElementById('line-' + i);
      line.classList.toggle('done', i < step);
    }
  }
  window.scrollTo({ top: 0, behavior: 'smooth' });

  // Populate links and competences when entering step 2
  if (step === 2 && selectedStructure) {
    populateStep2();
  }
}

// ‚îÄ‚îÄ Step 2 : Comp√©tences + R√©f√©rences (mock data pour maquette) ‚îÄ‚îÄ
// En production : scraping DECP, OPQIBI, OPQU, BDD M2BPO, analyse web IA

var currentCompetences = [];

// Mock : comp√©tences selon code NAF
var MOCK_COMPETENCES = {
  '7111Z': ['Architecte'],
  '7112B': [
    'AMO en technique',
    'Ma√Ætrise d\'≈ìuvre en g√©nie climatique complexe',
    'Ma√Ætrise d\'≈ìuvre en √©lectricit√© complexe',
    '√âtude d\'installations frigorifiques et de climatisation complexes',
    'Audit √©nerg√©tique des b√¢timents',
    'Ma√Ætrise d\'≈ìuvre de fluides complexes',
    'Direction de l\'Ex√©cution des Travaux'
  ],
  '7112A': [
    'Ing√©nierie',
    'Activit√© de m√©treur',
    '√âtudes techniques'
  ],
  '7490A': [
    'AMO en technique',
    'Conseil en d√©veloppement durable',
    'BIM Management',
    'Audit √©nerg√©tique des b√¢timents'
  ]
};

// Mock : r√©f√©rences DECP
var MOCK_REFERENCES = [
  { objet: 'R√©habilitation et extension du groupe scolaire Jean-Jaur√®s', acheteur: 'Ville de Montreuil', montant: 2850000, annee: '2024', nature: 'Travaux' },
  { objet: 'Construction d\'un centre aquatique intercommunal', acheteur: 'CA Grand Paris Sud', montant: 18500000, annee: '2023', nature: 'Travaux' },
  { objet: 'Ma√Ætrise d\'≈ìuvre pour la restructuration du b√¢timent B de l\'EHPAD Les Tilleuls', acheteur: 'D√©partement du Val-de-Marne', montant: 450000, annee: '2023', nature: 'Services' },
  { objet: 'Mission de diagnostic √©nerg√©tique et √©tude de faisabilit√© ‚Äì patrimoine communal', acheteur: 'Commune de Palaiseau', montant: 85000, annee: '2022', nature: 'Services' },
  { objet: 'Conception et suivi de travaux pour la construction de 42 logements collectifs', acheteur: 'OPH Essonne Habitat', montant: 1200000, annee: '2022', nature: 'Services' },
  { objet: 'R√©novation thermique de l\'√©cole maternelle Pasteur', acheteur: 'Ville de Massy', montant: 320000, annee: '2021', nature: 'Travaux' }
];

function populateStep2() {
  if (!selectedStructure) return;
  currentCompetences = [];
  document.getElementById('competences-list').innerHTML = '';
  document.getElementById('comp-loading').style.display = 'none';

  var naf = (selectedStructure.activite_code || '').replace(/[\.\s\-]/g, '').toUpperCase();

  // ‚îÄ‚îÄ Comp√©tences ‚îÄ‚îÄ
  var tags = MOCK_COMPETENCES[naf] || [];
  if (tags.length === 0 && selectedStructure.activite_label) {
    tags = [selectedStructure.activite_label];
  }

  var source = '';
  if (naf === '7111Z') {
    source = 'D√©tect√© depuis votre code NAF. Ajoutez vos autres comp√©tences.';
  } else if (['7112B', '7490A'].indexOf(naf) !== -1) {
    source = 'Qualifications import√©es depuis <strong>OPQIBI</strong>. Vous pouvez en ajouter ou en supprimer.';
  } else {
    source = 'Ajoutez les comp√©tences de votre structure.';
  }
  document.getElementById('comp-subtitle').innerHTML = source;

  for (var i = 0; i < tags.length; i++) {
    addCompetenceTag(tags[i]);
  }

  // ‚îÄ‚îÄ R√©f√©rences ‚îÄ‚îÄ
  populateReferences();
}

function addCompetenceTag(label) {
  if (!label || label.trim() === '') return;
  label = label.trim();
  var lower = label.toLowerCase();
  for (var i = 0; i < currentCompetences.length; i++) {
    if (currentCompetences[i].toLowerCase() === lower) return;
  }
  currentCompetences.push(label);
  renderCompetences();
}

function removeCompetence(index) {
  currentCompetences.splice(index, 1);
  renderCompetences();
}

function renderCompetences() {
  var list = document.getElementById('competences-list');
  var html = '';
  for (var i = 0; i < currentCompetences.length; i++) {
    html += '<div class="comp-tag active" style="display:inline-flex; align-items:center; gap:6px;">' +
      escapeHtml(currentCompetences[i]) +
      '<span onclick="removeCompetence(' + i + ')" style="cursor:pointer; font-size:14px; opacity:0.6; margin-left:2px;" title="Supprimer">‚úï</span>' +
    '</div>';
  }
  list.innerHTML = html;
}

function addCompetence() {
  var input = document.getElementById('input-add-comp');
  var val = input.value.trim();
  if (val) {
    addCompetenceTag(val);
    input.value = '';
  }
}

// ‚îÄ‚îÄ R√©f√©rences mock ‚îÄ‚îÄ

function populateReferences() {
  var loadEl = document.getElementById('decp-loading');
  var emptyEl = document.getElementById('decp-empty');
  var resultsEl = document.getElementById('decp-results');
  var listEl = document.getElementById('decp-list');
  var countEl = document.getElementById('decp-count');

  // Simulate brief loading
  loadEl.style.display = 'block';
  emptyEl.style.display = 'none';
  resultsEl.style.display = 'none';

  setTimeout(function() {
    loadEl.style.display = 'none';
    var data = MOCK_REFERENCES;

    if (data.length === 0) {
      emptyEl.style.display = 'block';
      return;
    }

    countEl.textContent = data.length + ' march√©' + (data.length > 1 ? 's' : '') + ' trouv√©' + (data.length > 1 ? 's' : '');
    resultsEl.style.display = 'block';

    var html = '';
    for (var i = 0; i < data.length; i++) {
      var m = data[i];
      var montant = formatMontant(m.montant);

      html += '<label class="ref-card" style="cursor:pointer; display:flex; align-items:flex-start;">' +
        '<input type="checkbox" class="decp-check" checked style="margin-right:12px; margin-top:4px; accent-color:var(--accent); width:18px; height:18px; flex-shrink:0;">' +
        '<div style="flex:1; min-width:0;">' +
          '<h4>' + escapeHtml(m.objet) + '</h4>' +
          '<p>' + escapeHtml(m.acheteur) +
          (m.nature ? ' ¬∑ <span style="font-size:10px; font-weight:600; color:var(--accent); background:var(--accent-light); padding:2px 6px; border-radius:3px;">' + escapeHtml(m.nature) + '</span>' : '') +
          '</p>' +
        '</div>' +
        '<div class="ref-amount">' + montant + (m.annee ? '<div class="ref-year">' + m.annee + '</div>' : '') + '</div>' +
      '</label>';
    }
    listEl.innerHTML = html;
  }, 600);
}

function toggleAllDecp() {
  var checks = document.querySelectorAll('.decp-check');
  var allChecked = Array.prototype.every.call(checks, function(c) { return c.checked; });
  checks.forEach(function(c) { c.checked = !allChecked; });
  document.getElementById('toggle-all-label').textContent = allChecked ? 'Tout s√©lectionner' : 'Tout d√©s√©lectionner';
}

function formatMontant(val) {
  var n = parseFloat(val);
  if (isNaN(n)) return 'N/C';
  if (n >= 1000000) return (n / 1000000).toFixed(1).replace('.0', '') + ' M‚Ç¨';
  if (n >= 1000) return Math.round(n / 1000) + ' k‚Ç¨';
  return Math.round(n) + ' ‚Ç¨';
}
</script>
</body>
</html>
